apiVersion: apps/v1
kind: Deployment
metadata:
  name: management-overhead-client
spec:
  replicas: 10
  selector:
    matchLabels:
      app: management-overhead-client
  template:
    metadata:
      labels:
        app: management-overhead-client
    spec:
      containers:
      - name: management-overhead-client
        image: ghcr.io/jakobke/oakestra/overhead-management-client:latest
        imagePullPolicy: Always 
        env:  
        - name: NUM_PROGRAMS
          value: "10"  
        - name: DURATION_IN_SECONDS
          value: "60"  
        - name: SERVICE_URL
          value: "management-overhead.default.svc.cluster.local" 

---

apiVersion: policy.karmada.io/v1alpha1
kind: PropagationPolicy
metadata:
  name: management-overhead-client-propagation
spec:
  resourceSelectors:
    - apiVersion: apps/v1
      kind: Deployment
      name: management-overhead-client
  placement:
    clusterAffinity:
      clusterNames:
        - member1
        - member2
    replicaScheduling:
      replicaDivisionPreference: Weighted
      replicaSchedulingType: Divided
      weightPreference:
        staticWeightList:
          - targetCluster:
              clusterNames:
                - member1
            weight: 1
          - targetCluster:
              clusterNames:
                - member2
            weight: 1
--- 

apiVersion: apps/v1
kind: Deployment
metadata:
  name: management-overhead-server
spec:
  replicas: 10
  selector:
    matchLabels:
      app: management-overhead-server
  template:
    metadata:
      labels:
        app: management-overhead-server
    spec:
      containers:
      - name: management-overhead-server
        image: ghcr.io/jakobke/oakestra/overhead-management-server:latest
        imagePullPolicy: Always 
    

---

apiVersion: policy.karmada.io/v1alpha1
kind: PropagationPolicy
metadata:
  name: management-overhead-server-propagation
spec:
  resourceSelectors:
    - apiVersion: apps/v1
      kind: Deployment
      name: management-overhead-server
  placement:
    clusterAffinity:
      clusterNames:
        - member1
        - member2
    replicaScheduling:
      replicaDivisionPreference: Weighted
      replicaSchedulingType: Divided
      weightPreference:
        staticWeightList:
          - targetCluster:
              clusterNames:
                - member1
            weight: 1
          - targetCluster:
              clusterNames:
                - member2
            weight: 1